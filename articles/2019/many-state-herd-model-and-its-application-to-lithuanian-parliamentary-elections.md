Title: Many state herding model and its application to Lithuanian parliamentary elections
Date: 2019-06-25 08:00
Author: Aleksejus Kononovicius
Tags: interactive, agent-based models, opinion dynamics, A. Kononovicius, Lithuania, voter model, Kirman model
Slug: many-state-herd-model-and-its-application-to-lithuanian-parliamentary-elections
Status: published
Image_url: uploads/2019/many-state-herd-model-and-its-application-to-lithuanian-parliamentary-elections.png

Let us close this year with a model proposed by us and which is based on the
[Kirman model](/tag/kirman-model/). The main difference from the
[original model]({filename}/articles/2010/kirman-ants.md) is that here we have
multiple state dynamics. Yet unlike in our three state approach to the financial
markets (see the initial post [here]({filename}/articles/2011/three-group-kirman-agent-based-model-for-financial-markets.md)
or the article [cite id="Kononovicius2013EPL"])
this time we allow any number of states to be defined in the model
[cite id="Kononovicius2017Complexity,Kononovicius2018APPA"].
<!--more-->

While analyzing Lithuanian parliamentary election data (can be obtained from
[here](https://www.rinkejopuslapis.lt/ataskaitu-formavimas) or clean csv files
are available from my github repository
[here](https://github.com/akononovicius/lithuanian-parliamentary-election-data))
I noticed that data set for the 1992 election seems to be the cleanest - the
results of the three major parties are clearly Beta distributed, while for the
fourth one the distribution is not that clear. I have looked at the vote shares
(percentage of votes) at the polling station level. In this way I assume that
all polling stations are similar and observing vote shares within them is the
same as drawing samples from stationary distribution reached by some opinion
dynamics model. As the vote share distribution is Beta,
[Kirman's herding model]({filename}/articles/2010/kirman-ants.md) is a likely
candidate.

## The model

But to build a proper model we need to extend [Kirman model]({filename}/articles/2010/kirman-ants.md) 
to include multi-state dynamics. This can be easily done be rewritting the one
step transition probabilities as follows:

\begin{equation}
P \left( X\_i \rightarrow X\_i +1 \right) = \sum\_{j \neq i} X\_j \left( \varepsilon\_{ji} + X\_i \right) h \Delta t ,
\end{equation}

\begin{equation}
P \left( X\_i \rightarrow X\_i -1 \right) = X\_i \sum\_{j \neq i} \left( \varepsilon\_{ij} + X\_j \right) h \Delta t .
\end{equation}

These pairs of transition probabilities are valid for all parties under consideration.
Namely if you want to model \\\( 4 \\\) parties (states), then you have to have
\\\( 8 \\\) one step transition probabilities.

These transition probabilities can be simplified by assuming that parties (states)
are perceived the same way from the perspective of the agents voting for the
other parties (being in other states). Then \\\( \varepsilon\_{ij} = \varepsilon\_j \\\)
and:

\begin{equation}
P \left( X\_i \rightarrow X\_i +1 \right) = \left( N - X\_i \right) \left( \varepsilon\_{i} + X\_i \right) h \Delta t ,
\end{equation}

\begin{equation}
P \left( X\_i \rightarrow X\_i -1 \right) = X\_i \left( \varepsilon\_{-i} + N - X\_i \right) h \Delta t .
\end{equation}

In the above \\\( \varepsilon\_{-i} = \sum\_{j \neq i} \varepsilon\_j \\\) is the
total attractiveness of the other parties. Under these conditions, by similarity
with the two state model, the stationary distribution is Beta distribution:

\begin{equation}
\frac{X\_i}{N} = x\_i \sim \mathcal{Be}\left(\varepsilon\_i , \varepsilon\_{-i}\right) .
\end{equation}

Otherwise the stationary distribution is unknown.

## The app

In the app below we have implemented this model using Gillespie algorithm
[cite id="Gillespie1977"]. Namely instead of one step transition probabilities
we have used transition rates, but this small change does not influence the
final result.

The app shows two figures. The one of the left show currently generated vote
shares for four different parties. The one of the right shows vote share
distribution (PDF) generated by the model. The default parameter set
(\\\( \varepsilon \\\) values) is the one which reproduces the vote share
distribution of the top four parties during the 1992 election the best [cite id="Kononovicius2017Complexity"].

Play around with the app to explore what results you can get.

[html5-interactive width="520" height="370" mode="iframe"
src="/uploads/models/voter/multi-state/index.html"]
